<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>NoShitProxy</title>
  <link rel="stylesheet" href="/static/styles.css?v=20260115">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="logo">
      <div class="logo-icon">‚óà</div>
      <span class="logo-text">NoShitProxy</span>
    </div>
    <div class="status-bar">
      <div class="status-item">
        <span>Proxy</span>
        <span class="status-value">127.0.0.1:8080</span>
      </div>
      <div class="status-item">
        <span>UI</span>
        <span class="status-value">127.0.0.1:8000</span>
      </div>
      <div class="status-item">
        <span>CA</span>
        <a href="http://mitm.it" class="status-value">mitm.it</a>
      </div>
      <div class="status-item">
        <button type="button" id="scope_btn" class="btn btn-ghost btn-sm">Scope</button>
      </div>
      <div class="status-item status-item-no-dot">
        <button type="button" id="theme_toggle" class="btn btn-ghost btn-sm theme-toggle" aria-pressed="false">
          <span class="theme-toggle-label">Dark</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Main App -->
  <main class="app-container">
    <!-- Tab radios -->
    <input type="radio" name="tabs" id="tab-history" class="tab-radio" checked>
    <input type="radio" name="tabs" id="tab-repeater" class="tab-radio">

    <!-- Tab Navigation -->
    <nav class="tab-nav">
      <label class="tab-label" for="tab-history">
        <span class="icon">üì°</span> HTTP History
      </label>
      <label class="tab-label" for="tab-repeater">
        <span class="icon">üîÑ</span> Repeater
      </label>
    </nav>

    <!-- Tab Panels -->
    <div class="tab-panels">
      
      <!-- History Panel - Burp Suite Style -->
      <section class="tab-panel panel-history">
        <!-- Top: History Table -->
          <div class="history-section">
          <div class="history-toolbar">
            <div class="history-filter-block toolbar-block">
              <div class="where-wrap">
                <div class="search-container">
                  <span class="search-icon">‚åï</span>
                  <input type="text" id="where" class="search-input" placeholder="SQL WHERE (Example: status=200 AND url LIKE '%/api/%')">
                </div>
                <label class="checkbox-row where-check">
                  <input type="checkbox" id="hide_static" checked>
                  <span>Hide static</span>
                </label>
                <div class="ctrl-buttons">
                  <button type="button" id="where_apply" class="btn btn-ghost btn-sm">Apply</button>
                  <button type="button" id="where_clear" class="btn btn-ghost btn-sm">Clear</button>
                  <button type="button" id="where_help" class="btn btn-ghost btn-sm">Help</button>
                </div>
              </div>
            </div>

            <div class="history-page-block toolbar-block">
              <div class="history-controls">
                <label class="ctrl">
                  <span class="ctrl-label">Show</span>
                  <input type="number" id="page_size" class="ctrl-input" min="50" max="2000" step="50" value="1000">
                </label>

                <div class="page-nav">
                  <button type="button" id="page_newer" class="btn btn-ghost btn-sm" aria-label="Newer">‚Üê</button>
                  <div class="ctrl-meta" id="page_meta">Page 1</div>
                  <div class="page-count" id="page_count"></div>
                  <button type="button" id="page_older" class="btn btn-ghost btn-sm" aria-label="Older">‚Üí</button>
                  <button type="button" id="page_refresh" class="btn btn-ghost btn-sm" style="display:none;">Refresh</button>
                </div>
              </div>
            </div>
          </div>


          <div class="history-table-wrapper">
            <table class="history-table" id="history-table">
              <colgroup>
                <col data-col="num" style="width:48px">
                <col data-col="method" style="width:86px">
                <col data-col="url">
                <col data-col="status" style="width:78px">
                <col data-col="size" style="width:80px">
                <col data-col="time" style="width:70px">
              </colgroup>
              <thead>
                <tr>
                  <th data-col="num"><span>#</span><div class="resize-handle"></div></th>
                  <th data-col="method"><span>Method</span><div class="resize-handle"></div></th>
                  <th data-col="url"><span>URL</span><div class="resize-handle"></div></th>
                  <th data-col="status"><span>Status</span><div class="resize-handle"></div></th>
                  <th data-col="size"><span>Size</span><div class="resize-handle"></div></th>
                  <th data-col="time"><span>Time</span></th>
                </tr>
              </thead>
              <tbody id="flows"></tbody>
            </table>
          </div>
        </div>

        <!-- Bottom: Request/Response Split -->
        <div class="detail-section">
          <div class="detail-pane">
            <div class="pane-header">
              <span>Request</span>
              <div class="pane-actions">
                <button type="button" id="pretty-request" class="btn btn-ghost btn-sm">Pretty</button>
                <button type="button" id="raw-request-btn" class="btn btn-ghost btn-sm is-active">Raw</button>
              </div>
            </div>
            <div class="pane-content">
              <pre id="raw-request" class="raw-http">Select a request from the history above</pre>
            </div>
          </div>
          <div class="detail-pane">
            <div class="pane-header">
              <span>Response</span>
              <div class="pane-actions">
                <button type="button" id="pretty-response" class="btn btn-ghost btn-sm">Pretty</button>
                <button type="button" id="raw-response-btn" class="btn btn-ghost btn-sm is-active">Raw</button>
                <button type="button" id="load-full-response" class="btn btn-ghost btn-sm">Full</button>
                <button type="button" id="history_to_repeater" class="btn btn-ghost btn-sm">To Repeater</button>
                <button type="button" id="history_open" class="btn btn-ghost btn-sm">Open</button>
              </div>
            </div>
            <div class="pane-content">
              <pre id="raw-response" class="raw-http">Response will appear here</pre>
            </div>
          </div>
        </div>
      </section>

      <!-- Repeater Panel -->
      <section class="tab-panel panel-repeater">
          <div class="repeater-pane">
            <div class="pane-header">
              <span>Request</span>
              <div class="pane-actions">
                <button type="button" id="rep-mode-structured" class="btn btn-ghost btn-sm is-active">Structured</button>
                <button type="button" id="rep-mode-raw" class="btn btn-ghost btn-sm">Raw</button>
              </div>
            </div>
            <div class="rep-tabs-bar">
              <div id="rep-tabs" class="rep-tabs"></div>
              <button type="button" id="rep-new" class="btn btn-ghost btn-sm">Ôºã</button>
            </div>

            <div class="repeater-form">

            <div id="rep-structured-wrap" style="display:flex;flex-direction:column;gap:8px;flex:1;min-height:0;">
              <div class="form-row">
                <div class="form-group method-group">
                  <label class="form-label" for="rep_method">Method</label>
                  <input type="text" id="rep_method" class="form-input" value="GET">
                </div>
                <div class="form-group flex-1">
                  <label class="form-label" for="rep_url">URL</label>
                  <input type="text" id="rep_url" class="form-input" placeholder="https://example.com/api">
                </div>
              </div>
              <div class="form-group flex-grow">
                <label class="form-label" for="rep_headers">Headers</label>
                <textarea id="rep_headers" class="form-textarea" placeholder="Content-Type: application/json"></textarea>
              </div>
              <div class="form-group flex-grow">
                <label class="form-label" for="rep_body">Body</label>
                <textarea id="rep_body" class="form-textarea" placeholder='{"key": "value"}'></textarea>
              </div>
            </div>

            <div class="form-group flex-grow" id="rep-raw-wrap" style="display:none;">
              <label class="form-label" for="rep_raw">Raw request</label>
              <textarea id="rep_raw" class="form-textarea" placeholder="GET https://example.com/ HTTP/1.1&#10;Header: value&#10;&#10;body"></textarea>
            </div>

            <div class="form-row">
              <button type="button" id="send" class="btn btn-primary" style="flex: 1;">‚ö° Send</button>
              <button type="button" id="open" class="btn btn-ghost" style="flex: 1;">Open</button>
            </div>
          </div>
        </div>
        <div class="repeater-pane">
          <div class="pane-header">
            <span>Response</span>
            <div class="pane-actions">
              <button type="button" id="rep-pretty" class="btn btn-ghost btn-sm">Pretty</button>
              <button type="button" id="rep-raw" class="btn btn-ghost btn-sm is-active">Raw</button>
            </div>
          </div>
          <div class="pane-content">
            <pre id="rep_out" class="raw-http">Response will appear here...</pre>
          </div>
        </div>
      </section>

    </div>
  </main>

  <div id="help-modal" class="modal" style="display:none;">
    <div class="modal-backdrop" id="help-backdrop"></div>
    <div class="modal-card">
      <div class="modal-header">
        <div class="modal-title">SQL WHERE Help</div>
        <button type="button" id="help-close" class="btn btn-ghost btn-sm">Close</button>
      </div>
      <div class="modal-body">
        <div style="font-family: var(--font-mono); font-size: 0.8rem; white-space: pre-wrap; line-height: 1.4;">
Columns:
  id, ts, method, url, host, path, status, duration,
  req_size, resp_size, req_preview, resp_preview,
  req_headers_json, resp_headers_json, resp_body_text

Examples:
  status = 200
  method = 'POST' AND url LIKE '%/upload/%'
  resp_size > 100000
  duration IS NOT NULL AND duration < 0.2
  instr(resp_body_text, 'history.go(-1)') > 0
  resp_body_text LIKE '%&lt;-- Back%'

Notes:
  - Strings use single quotes: '...'
  - For substring match use LIKE '%text%' or instr(col, 'text') > 0
  - You can use AND/OR/NOT and parentheses.
        </div>
      </div>
    </div>
  </div>

  <div id="scope-modal" class="modal" style="display:none;">
    <div class="modal-backdrop" id="scope-backdrop"></div>
    <div class="modal-card">
      <div class="modal-header">
        <div class="modal-title">Scope</div>
        <button type="button" id="scope-close" class="btn btn-ghost btn-sm">Close</button>
      </div>
      <div class="modal-body">
        <label class="form-label" for="scope-include">Include patterns (one per line, wildcard)</label>
        <textarea id="scope-include" class="form-textarea" style="min-height:140px;" placeholder="*"></textarea>

        <label class="form-label" for="scope-exclude">Exclude patterns (one per line, wildcard)</label>
        <textarea id="scope-exclude" class="form-textarea" style="min-height:140px;" placeholder="*://*/favicon.ico&#10;*://*/*.css*&#10;*://*/*.js*"></textarea>

        <label class="checkbox-row">
          <input type="checkbox" id="scope-drop">
          <span>Drop out of scope (block requests)</span>
        </label>
      </div>
      <div class="modal-footer">
        <button type="button" id="scope-save" class="btn btn-primary">Save</button>
      </div>
    </div>
  </div>

  <div id="ctx-menu" class="ctx-menu" style="display:none;"></div>
  <script src="/static/app.js?v=20260115"></script>
</body>
</html>
